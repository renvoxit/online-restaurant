{% extends 'base.html' %}
{% block title %}Order History{% endblock %}
{% block content %}
<section class="orders-section fade-in">
  <h2 class="orders-title">Your Orders</h2>

  {% if orders %}
    {% for order in orders %}
    <div class="order-card">
      <div class="order-header">
        <h3>Order #{{ order.id }}</h3>
        <span class="order-status {{ order.status|lower }}">{{ order.status }}</span>
      </div>
      <p class="order-meta">
        <strong>Date:</strong> {{ order.date.strftime('%Y-%m-%d %H:%M') }}<br>
        <strong>Total:</strong> {{ "%.2f"|format(order.total_price) }} €
      </p>

      <ul class="order-list">
        {% for item in order.items %}
        <li>
          <span>{{ item.dish.name }} — {{ item.quantity }} pcs</span>
          <span class="order-price">{{ "%.2f"|format(item.dish.price * item.quantity) }} €</span>
        </li>
        {% endfor %}
      </ul>

      <div class="order-actions">
        <a href="{{ url_for('main.repeat_order', order_id=order.id) }}" class="btn-small edit">Repeat</a>
        {% if order.status == 'Pending' %}
          <a href="{{ url_for('main.cancel_order', order_id=order.id) }}" class="btn-small delete">Cancel</a>
        {% endif %}
      </div>
    </div>
    {% endfor %}
  {% else %}
    <p class="empty-text">You have no orders yet.</p>
  {% endif %}
</section>
{% endblock %}
